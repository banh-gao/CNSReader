<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.6.0_27) on Tue Dec 17 16:01:28 CET 2013 -->
<title>SignatureCardService</title>
<meta name="date" content="2013-12-17">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SignatureCardService";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../opencard/opt/signature/KeyImportCardService.html" title="interface in opencard.opt.signature"><span class="strong">PREV CLASS</span></a></li>
<li>NEXT CLASS</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?opencard/opt/signature/SignatureCardService.html" target="_top">FRAMES</a></li>
<li><a href="SignatureCardService.html" target="_top">NO FRAMES</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>SUMMARY:&nbsp;</li>
<li>NESTED&nbsp;|&nbsp;</li>
<li>FIELD&nbsp;|&nbsp;</li>
<li>CONSTR&nbsp;|&nbsp;</li>
<li><a href="#method_summary">METHOD</a></li>
</ul>
<ul class="subNavList">
<li>DETAIL:&nbsp;</li>
<li>FIELD&nbsp;|&nbsp;</li>
<li>CONSTR&nbsp;|&nbsp;</li>
<li><a href="#method_detail">METHOD</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<p class="subTitle">opencard.opt.signature</p>
<h2 title="Interface SignatureCardService" class="title">Interface SignatureCardService</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><a href="../../../opencard/opt/service/CardServiceInterface.html" title="interface in opencard.opt.service">CardServiceInterface</a>, <a href="../../../opencard/opt/security/SecureService.html" title="interface in opencard.opt.security">SecureService</a></dd>
</dl>
<dl>
<dt>All Known Subinterfaces:</dt>
<dd><a href="../../../opencard/opt/signature/KeyGenerationCardService.html" title="interface in opencard.opt.signature">KeyGenerationCardService</a>, <a href="../../../de/cardcontact/opencard/service/smartcardhsm/KeyGenerationCardServiceWithSpec.html" title="interface in de.cardcontact.opencard.service.smartcardhsm">KeyGenerationCardServiceWithSpec</a>, <a href="../../../opencard/opt/signature/KeyImportCardService.html" title="interface in opencard.opt.signature">KeyImportCardService</a></dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../de/cardcontact/opencard/service/signature/ISSSSignatureService.html" title="class in de.cardcontact.opencard.service.signature">ISSSSignatureService</a>, <a href="../../../de/cardcontact/opencard/service/smartcardhsm/SmartCardHSMCardService.html" title="class in de.cardcontact.opencard.service.smartcardhsm">SmartCardHSMCardService</a></dd>
</dl>
<hr>
<br>
<pre>public interface <strong>SignatureCardService</strong>
extends <a href="../../../opencard/opt/service/CardServiceInterface.html" title="interface in opencard.opt.service">CardServiceInterface</a>, <a href="../../../opencard/opt/security/SecureService.html" title="interface in opencard.opt.security">SecureService</a></pre>
<div class="block"><tt>SignatureCardService</tt>
 The SignatureCardService offers methods to generate and verify a signature
 as well as key import, verification and generation methods. Many smartcard
 applications will work with existing keys imported during initialization or
 personalization instead of importing/generating them at runtime. Thus the
 functionality for
 <ul>
 <li>signature generation and verification
 <li>key import and verification
 <li>key generation
 </ul>
 is split into three interfaces "SignatureCardService", "KeyImportCardService"
 and "KeyGenerationCardService". Card service realizations of these interfaces
 need only implement the functionality needed by the application or supported
 by the specific card. This solution also offers potential for downsizing
 opencard for use in embedded devises with small memory resources.</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>$Id: SignatureCardService.java,v 1.2 1999/10/22 16:07:35 damke Exp $</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Michael Baentsch (mib@zurich.ibm.com), Thomas Schaeck   (schaeck@de.ibm.com), Reto Hermann     (rhe@zurich.ibm.com), Peter Bendel     (peter_bendel@de.ibm.com)</dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/KeyGenerationCardService.html" title="interface in opencard.opt.signature"><code>KeyGenerationCardService</code></a>, 
<a href="../../../opencard/opt/signature/KeyImportCardService.html" title="interface in opencard.opt.signature"><code>KeyImportCardService</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#signData(opencard.opt.security.PrivateKeyRef, java.lang.String, byte[])">signData</a></strong>(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
        java.lang.String&nbsp;signAlgorithm,
        byte[]&nbsp;data)</code>
<div class="block">Generate a digital Signature.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#signData(opencard.opt.security.PrivateKeyRef, java.lang.String, java.lang.String, byte[])">signData</a></strong>(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
        java.lang.String&nbsp;signAgorithm,
        java.lang.String&nbsp;padAlgorithm,
        byte[]&nbsp;data)</code>
<div class="block">Generate a digital Signature (overload method that allows to specify
 the padding algorithm).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#signHash(opencard.opt.security.PrivateKeyRef, java.lang.String, byte[])">signHash</a></strong>(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
        java.lang.String&nbsp;signAgorithm,
        byte[]&nbsp;hash)</code>
<div class="block">Generate a digital Signature on the provided hash.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#signHash(opencard.opt.security.PrivateKeyRef, java.lang.String, java.lang.String, byte[])">signHash</a></strong>(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
        java.lang.String&nbsp;signAgorithm,
        java.lang.String&nbsp;padAlgorithm,
        byte[]&nbsp;hash)</code>
<div class="block">Generate a digital Signature on the provided hash
 (Overloaded method that allows to specify the padding algorithm).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#verifySignedData(opencard.opt.security.PublicKeyRef, java.lang.String, byte[], byte[])">verifySignedData</a></strong>(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                java.lang.String&nbsp;signAlgorithm,
                byte[]&nbsp;data,
                byte[]&nbsp;signature)</code>
<div class="block">Verify a digital Signature including hashing.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#verifySignedData(opencard.opt.security.PublicKeyRef, java.lang.String, java.lang.String, byte[], byte[])">verifySignedData</a></strong>(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                java.lang.String&nbsp;signAlgorithm,
                java.lang.String&nbsp;padAlgorithm,
                byte[]&nbsp;data,
                byte[]&nbsp;signature)</code>
<div class="block">Verify a digital Signature including hashing
 (overload method that allows to specify the padding algorithm to be used).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#verifySignedHash(opencard.opt.security.PublicKeyRef, java.lang.String, byte[], byte[])">verifySignedHash</a></strong>(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                java.lang.String&nbsp;signAlgorithm,
                byte[]&nbsp;hash,
                byte[]&nbsp;signature)</code>
<div class="block">Verify a digital Signature.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../opencard/opt/signature/SignatureCardService.html#verifySignedHash(opencard.opt.security.PublicKeyRef, java.lang.String, java.lang.String, byte[], byte[])">verifySignedHash</a></strong>(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                java.lang.String&nbsp;signAlgorithm,
                java.lang.String&nbsp;padAlgorithm,
                byte[]&nbsp;hash,
                byte[]&nbsp;signature)</code>
<div class="block">Verify a digital Signature
 (overloaded method that allows to specify the padding algorithm to be used).</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_opencard.opt.service.CardServiceInterface">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;opencard.opt.service.<a href="../../../opencard/opt/service/CardServiceInterface.html" title="interface in opencard.opt.service">CardServiceInterface</a></h3>
<code><a href="../../../opencard/opt/service/CardServiceInterface.html#getCard()">getCard</a>, <a href="../../../opencard/opt/service/CardServiceInterface.html#setCHVDialog(opencard.core.service.CHVDialog)">setCHVDialog</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_opencard.opt.security.SecureService">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;opencard.opt.security.<a href="../../../opencard/opt/security/SecureService.html" title="interface in opencard.opt.security">SecureService</a></h3>
<code><a href="../../../opencard/opt/security/SecureService.html#provideCredentials(opencard.opt.security.SecurityDomain, opencard.opt.security.CredentialBag)">provideCredentials</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="signData(opencard.opt.security.PrivateKeyRef, java.lang.String, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signData</h4>
<pre>byte[]&nbsp;signData(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
              java.lang.String&nbsp;signAlgorithm,
              byte[]&nbsp;data)
                throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                       java.security.InvalidKeyException,
                       <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Generate a digital Signature.
 First hash the data, then pad the hash and then
 apply the PKA algorithm to the padded hash.
 <p>
 The padding algorithm is chosen as defined in the Java Cryptography Architecture Specification.
 <p>
 The standard algorithm name must be specified as defined in the
 Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>MD5withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD5 MessageDigest Algorithm.
 <DT>MD2withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD2 MessageDigest Algorithm.
 <DT>SHA1withRSA<DD>The Signature algorithm obtained by combining the RSA
                    AsymmetricCipher algorithm with the SHA-1 MessageDigest Algorithm.
 <DT>SHA1withDSA<DD>Digital Signature Algorithm, as defined in Digital Signature Standard,
                    NIST FIPS 186.  This standard defines a digital signature algorithm
                    that uses the RawDSA asymmetric transformation along with the SHA-1
                    message digest algorithm.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>privateKey</code> - a reference to the private key on card to be used for signing</dd><dd><code>signAlgorithm</code> - standard digital signature algorithm name</dd><dd><code>data</code> - data to be signed</dd>
<dt><span class="strong">Returns:</span></dt><dd>signature</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="signData(opencard.opt.security.PrivateKeyRef, java.lang.String, java.lang.String, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signData</h4>
<pre>byte[]&nbsp;signData(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
              java.lang.String&nbsp;signAgorithm,
              java.lang.String&nbsp;padAlgorithm,
              byte[]&nbsp;data)
                throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                       java.security.InvalidKeyException,
                       <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Generate a digital Signature (overload method that allows to specify
 the padding algorithm).
 First hash the data, then pad the hash and then
 apply the PKA algorithm to the padded hash.
 <p>
 The standard algorithm name must be specified as defined in the
 Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>MD5withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD5 MessageDigest Algorithm.
 <DT>MD2withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD2 MessageDigest Algorithm.
 <DT>SHA1withRSA<DD>The Signature algorithm obtained by combining the RSA
                    AsymmetricCipher algorithm with the SHA-1 MessageDigest Algorithm.
 <DT>SHA1withDSA<DD>Digital Signature Algorithm, as defined in Digital Signature Standard,
                    NIST FIPS 186.  This standard defines a digital signature algorithm
                    that uses the RawDSA asymmetric transformation along with the SHA-1
                    message digest algorithm.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>privateKey</code> - a reference to the private key on card to be used for signing</dd><dd><code>signAgorithm</code> - standard digital signature algorithm name</dd><dd><code>padAlgorithm</code> - padding algorithm name, for example one of
         ISO9796,
         PKCS#1,
         ZEROPADDING</dd><dd><code>data</code> - data to be signed</dd>
<dt><span class="strong">Returns:</span></dt><dd>signature</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="signHash(opencard.opt.security.PrivateKeyRef, java.lang.String, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signHash</h4>
<pre>byte[]&nbsp;signHash(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
              java.lang.String&nbsp;signAgorithm,
              byte[]&nbsp;hash)
                throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                       java.security.InvalidKeyException,
                       <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Generate a digital Signature on the provided hash.
 Since hashing of large amounts of data may be slow if performed on card
 this method allows to hash outside the card service and just perform
 the signature operation on card.
 Pad the hash and then
 apply the PKA algorithm to the padded hash.
 <p>
 The padding algorithm is chosen as defined in the Java Cryptography Architecture Specification.
 <p>
 Use a key algorithm name (not a digital signature algorithm name, because digital
 signature algorithms include hashing)
 a defined in the Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>    DSA<DD>  The asymmetric transformation described in NIST FIPS 186, described
                  as the "DSA Sign Operation" and the "DSA Verify Operation", prior to
                  creating a digest.  The input to DSA is always 20 bytes long.

 <DT>    RSA<DD>  The Rivest, Shamir and Adleman AsymmetricCipher algorithm. RSA
                  Encryption as defined in the RSA Laboratory Technical Note PKCS#1.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>privateKey</code> - a reference to the private key on card to be used for signing</dd><dd><code>signAgorithm</code> - standard key algorithm name</dd><dd><code>hash</code> - the hash/digest to be signed</dd>
<dt><span class="strong">Returns:</span></dt><dd>signature</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="signHash(opencard.opt.security.PrivateKeyRef, java.lang.String, java.lang.String, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signHash</h4>
<pre>byte[]&nbsp;signHash(<a href="../../../opencard/opt/security/PrivateKeyRef.html" title="interface in opencard.opt.security">PrivateKeyRef</a>&nbsp;privateKey,
              java.lang.String&nbsp;signAgorithm,
              java.lang.String&nbsp;padAlgorithm,
              byte[]&nbsp;hash)
                throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                       java.security.InvalidKeyException,
                       <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Generate a digital Signature on the provided hash
 (Overloaded method that allows to specify the padding algorithm).
 Since hashing of large amounts of data may be slow if performed on card
 this method allows to hash outside the card service and just perform
 the signature operation on card.
 Pad the hash and then
 apply the PKA algorithm to the padded hash.
 <p>
 Use a key algorithm name (not a digital signature algorithm name, because digital
 signature algorithms include hashing)
 a defined in the Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>    DSA<DD>  The asymmetric transformation described in NIST FIPS 186, described
                  as the "DSA Sign Operation" and the "DSA Verify Operation", prior to
                  creating a digest.  The input to DSA is always 20 bytes long.

 <DT>    RSA<DD>  The Rivest, Shamir and Adleman AsymmetricCipher algorithm. RSA
                  Encryption as defined in the RSA Laboratory Technical Note PKCS#1.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>privateKey</code> - a reference to the private key on card to be used for signing</dd><dd><code>signAgorithm</code> - standard key algorithm name</dd><dd><code>padAlgorithm</code> - padding algorithm name, for example one of
         ISO9796,
         PKCS#1,
         ZEROPADDING</dd><dd><code>hash</code> - the hash/digest to be signed</dd>
<dt><span class="strong">Returns:</span></dt><dd>signature</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="verifySignedData(opencard.opt.security.PublicKeyRef, java.lang.String, byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignedData</h4>
<pre>boolean&nbsp;verifySignedData(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                       java.lang.String&nbsp;signAlgorithm,
                       byte[]&nbsp;data,
                       byte[]&nbsp;signature)
                         throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                                java.security.InvalidKeyException,
                                <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Verify a digital Signature including hashing.
 First hash the data, then pad the hash,
 apply the PKA algorithm to the padded hash, then compare the result
 to the provided signature.
 <p>
 The padding algorithm is chosen as defined in the Java Cryptography Architecture Specification.
 <p>
 The standard algorithm name must be specified as defined in the
 Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>MD5withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD5 MessageDigest Algorithm.
 <DT>MD2withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD2 MessageDigest Algorithm.
 <DT>SHA1withRSA<DD>The Signature algorithm obtained by combining the RSA
                    AsymmetricCipher algorithm with the SHA-1 MessageDigest Algorithm.
 <DT>SHA1withDSA<DD>Digital Signature Algorithm, as defined in Digital Signature Standard,
                    NIST FIPS 186.  This standard defines a digital signature algorithm
                    that uses the RawDSA asymmetric transformation along with the SHA-1
                    message digest algorithm.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>publicKey</code> - a reference to the public key on card to be used for signature validation</dd><dd><code>signAlgorithm</code> - standard digital signature algorithm name</dd><dd><code>data</code> - the data for which the signature should be verified</dd><dd><code>signature</code> - signature to be verified</dd>
<dt><span class="strong">Returns:</span></dt><dd>True if signature valdidation was successfull</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="verifySignedData(opencard.opt.security.PublicKeyRef, java.lang.String, java.lang.String, byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignedData</h4>
<pre>boolean&nbsp;verifySignedData(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                       java.lang.String&nbsp;signAlgorithm,
                       java.lang.String&nbsp;padAlgorithm,
                       byte[]&nbsp;data,
                       byte[]&nbsp;signature)
                         throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                                java.security.InvalidKeyException,
                                <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Verify a digital Signature including hashing
 (overload method that allows to specify the padding algorithm to be used).
 First hash the data, then pad the hash,
 apply the PKA algorithm to the padded hash, then compare the result
 to the provided signature.
 <p>
 The standard algorithm name must be specified as defined in the
 Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>MD5withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD5 MessageDigest Algorithm.
 <DT>MD2withRSA<DD>The Signature algorithm obtained by combining the RSA
                   AsymmetricCipher algorithm with the MD2 MessageDigest Algorithm.
 <DT>SHA1withRSA<DD>The Signature algorithm obtained by combining the RSA
                    AsymmetricCipher algorithm with the SHA-1 MessageDigest Algorithm.
 <DT>SHA1withDSA<DD>Digital Signature Algorithm, as defined in Digital Signature Standard,
                    NIST FIPS 186.  This standard defines a digital signature algorithm
                    that uses the RawDSA asymmetric transformation along with the SHA-1
                    message digest algorithm.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>publicKey</code> - a reference to the public key on card to be used for signature validation</dd><dd><code>signAlgorithm</code> - standard digital signature algorithm name</dd><dd><code>padAlgorithm</code> - padding algorithm name, for example one of
         ISO9796,
         PKCS#1,
         ZEROPADDING</dd><dd><code>data</code> - the data for which the signature should be verified</dd><dd><code>signature</code> - signature to be verified</dd>
<dt><span class="strong">Returns:</span></dt><dd>True if signature valdidation was successfull</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="verifySignedHash(opencard.opt.security.PublicKeyRef, java.lang.String, byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignedHash</h4>
<pre>boolean&nbsp;verifySignedHash(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                       java.lang.String&nbsp;signAlgorithm,
                       byte[]&nbsp;hash,
                       byte[]&nbsp;signature)
                         throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                                java.security.InvalidKeyException,
                                <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Verify a digital Signature.
 Since hashing of large amounts of data may be slow if performed on card
 this method allows to hash outside the card service and just perform
 the signature verificationoperation on card.
 Pad the provided hash,
 apply the PKA algorithm to the padded hash, then compare the result
 to the provided signature.
 <p>
 The padding algorithm is chosen as defined in the Java Cryptography Architecture Specification.
 <p>
 Use a key algorithm name (not a digital signature algorithm name, because digital
 signature algorithms include hashing)
 a defined in the Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>    DSA<DD>  The asymmetric transformation described in NIST FIPS 186, described
                  as the "DSA Sign Operation" and the "DSA Verify Operation", prior to
                  creating a digest.  The input to DSA is always 20 bytes long.

 <DT>    RSA<DD>  The Rivest, Shamir and Adleman AsymmetricCipher algorithm. RSA
                  Encryption as defined in the RSA Laboratory Technical Note PKCS#1.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>publicKey</code> - a reference to the public key on card to be used for signature validation</dd><dd><code>signAlgorithm</code> - standard key algorithm name</dd><dd><code>hash</code> - The hash for which the signature should be verified.</dd><dd><code>signature</code> - signature to be verified</dd>
<dt><span class="strong">Returns:</span></dt><dd>True if signature valdidation was successfull</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
<a name="verifySignedHash(opencard.opt.security.PublicKeyRef, java.lang.String, java.lang.String, byte[], byte[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>verifySignedHash</h4>
<pre>boolean&nbsp;verifySignedHash(<a href="../../../opencard/opt/security/PublicKeyRef.html" title="interface in opencard.opt.security">PublicKeyRef</a>&nbsp;publicKey,
                       java.lang.String&nbsp;signAlgorithm,
                       java.lang.String&nbsp;padAlgorithm,
                       byte[]&nbsp;hash,
                       byte[]&nbsp;signature)
                         throws <a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a>,
                                java.security.InvalidKeyException,
                                <a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></pre>
<div class="block">Verify a digital Signature
 (overloaded method that allows to specify the padding algorithm to be used).
 Since hashing of large amounts of data may be slow if performed on card
 this method allows to hash outside the card service and just perform
 the signature verification operation on card.
 Pad the provided hash,
 apply the PKA algorithm to the padded hash, then compare the result
 to the provided signature.
 <p>
 Use a key algorithm name (not a digital signature algorithm name, because digital
 signature algorithms include hashing)
 a defined in the Java Cryptography Architecture API Specification & Reference,
 for example
 <DL COMPACT>
 <DT>    DSA<DD>  The asymmetric transformation described in NIST FIPS 186, described
                  as the "DSA Sign Operation" and the "DSA Verify Operation", prior to
                  creating a digest.  The input to DSA is always 20 bytes long.

 <DT>    RSA<DD>  The Rivest, Shamir and Adleman AsymmetricCipher algorithm. RSA
                  Encryption as defined in the RSA Laboratory Technical Note PKCS#1.
 </DL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>publicKey</code> - a reference to the public key on card to be used for signature validation</dd><dd><code>signAlgorithm</code> - standard key algorithm name</dd><dd><code>padAlgorithm</code> - padding algorithm name, for example one of
         ISO9796,
         PKCS#1,
         ZEROPADDING</dd><dd><code>hash</code> - The hash for which the signature should be verified.</dd><dd><code>signature</code> - signature to be verified</dd>
<dt><span class="strong">Returns:</span></dt><dd>True if signature valdidation was successfull</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - Thrown when the key is not valid or does not match the requested algorithm.</dd>
<dd><code><a href="../../../opencard/core/service/CardServiceException.html" title="class in opencard.core.service">CardServiceException</a></code> - any subclass of CardServiceException</dd>
<dd><code><a href="../../../opencard/core/terminal/CardTerminalException.html" title="class in opencard.core.terminal">CardTerminalException</a></code> - any subclass of CardTerminalException</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../opencard/opt/signature/JCAStandardNames.html" title="interface in opencard.opt.signature"><code>JCAStandardNames</code></a></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../opencard/opt/signature/KeyImportCardService.html" title="interface in opencard.opt.signature"><span class="strong">PREV CLASS</span></a></li>
<li>NEXT CLASS</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?opencard/opt/signature/SignatureCardService.html" target="_top">FRAMES</a></li>
<li><a href="SignatureCardService.html" target="_top">NO FRAMES</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>SUMMARY:&nbsp;</li>
<li>NESTED&nbsp;|&nbsp;</li>
<li>FIELD&nbsp;|&nbsp;</li>
<li>CONSTR&nbsp;|&nbsp;</li>
<li><a href="#method_summary">METHOD</a></li>
</ul>
<ul class="subNavList">
<li>DETAIL:&nbsp;</li>
<li>FIELD&nbsp;|&nbsp;</li>
<li>CONSTR&nbsp;|&nbsp;</li>
<li><a href="#method_detail">METHOD</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
